<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to MetaboStatR • MetaboStatR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to MetaboStatR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboStatR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to MetaboStatR</a>
    </li>
    <li>
      <a href="../articles/metabolomics-workflow.html">Complete Metabolomics Analysis Workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to MetaboStatR</h1>
                        <h4 data-toc-skip class="author">John Lennon L.
Calorio</h4>
            
            <h4 data-toc-skip class="date">2025-08-19</h4>
      

      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>MetaboStatR provides a comprehensive workflow for analyzing
metabolomics data. This package is designed to handle the complete
pipeline from raw data preprocessing to statistical analysis and
visualization, with particular emphasis on managing multiple groups and
batch effects.</p>
</div>
<div class="section level2">
<h2 id="what-is-metabolomics">What is Metabolomics?<a class="anchor" aria-label="anchor" href="#what-is-metabolomics"></a>
</h2>
<p>Metabolomics is the large-scale study of small molecules, commonly
known as metabolites, within cells, biofluids, tissues, or organisms.
These metabolites are the end products of cellular processes and their
levels can be regarded as the ultimate response of biological systems to
genetic or environmental changes.</p>
</div>
<div class="section level2">
<h2 id="key-features-of-metabostatr">Key Features of MetaboStatR<a class="anchor" aria-label="anchor" href="#key-features-of-metabostatr"></a>
</h2>
<ul>
<li>
<strong>Comprehensive preprocessing</strong>: Missing value
handling, normalization, transformation, and scaling</li>
<li>
<strong>Batch effect correction</strong>: Remove technical variation
between experimental runs</li>
<li>
<strong>Multivariate analysis</strong>: PCA, PLS-DA, OPLS-DA,
sPLS-DA for exploratory analysis and biomarker discovery</li>
<li>
<strong>Statistical testing</strong>: Identify significantly
different metabolites between groups</li>
<li>
<strong>Rich visualization</strong>: Generate publication-ready
plots including volcano plots, PCA plots, and more</li>
<li>
<strong>Reproducible workflow</strong>: Standardized pipeline
ensuring consistent results</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub (once package is properly structured)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"jllcalorio/MetaboStatR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MetaboStatR</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-format-requirements">Data Format Requirements<a class="anchor" aria-label="anchor" href="#data-format-requirements"></a>
</h2>
<p>Before using MetaboStatR, ensure your data follows the correct
format:</p>
<div class="section level3">
<h3 id="required-structure">Required Structure<a class="anchor" aria-label="anchor" href="#required-structure"></a>
</h3>
<ul>
<li>
<strong>1st row:</strong> Unique sample names</li>
<li>
<strong>2nd row:</strong> Subject ID (used only when 3rd row
“Replicate” is not empty</li>
<li>
<strong>3rd row:</strong> Technical replicate IDs</li>
<li>
<strong>4th row:</strong> Groups</li>
<li>
<strong>5th row:</strong> Unique batch numbers</li>
<li>
<strong>6th row:</strong> Uniqee injection sequences</li>
<li>
<strong>7th row:</strong> Values used for normalization (e.g.,
specific weight)</li>
<li>
<strong>8th row:</strong> Response (for cases when the independent
variable is not “Group” in 4th row, but rather numeric)</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-data-structure-with-correct-1st-column-entries">Example Data Structure with Correct 1st Column Entries<a class="anchor" aria-label="anchor" href="#example-data-structure-with-correct-1st-column-entries"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example data format</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S001"</span>, <span class="st">"S002"</span>, <span class="st">"S003"</span>, <span class="st">"S004"</span>, <span class="st">"S005"</span>, <span class="st">"S006"</span><span class="op">)</span>,</span>
<span>  SubjectID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Control"</span>, <span class="st">"Control"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span>, <span class="st">"Treatment"</span><span class="op">)</span>,</span>
<span>  Batch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Batch1"</span>, <span class="st">"Batch1"</span>, <span class="st">"Batch2"</span>, <span class="st">"Batch1"</span>, <span class="st">"Batch2"</span>, <span class="st">"Batch2"</span><span class="op">)</span>,</span>
<span>  Injection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span> ,<span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Normalization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">1.3</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">2</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  Response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<div class="section level3">
<h3 id="load-and-inspect-data">1. Load and Inspect Data<a class="anchor" aria-label="anchor" href="#load-and-inspect-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quality-check your data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_DataQualityCheck.html">perform_DataQualityCheck</a></span><span class="op">(</span><span class="st">"file_location_of_your_metabolomics_data.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preprocessing">2. Data Preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<p>The preprocessing step is crucial for metabolomics data quality.
These preprocessing steps (in specific order) include:</p>
<ol style="list-style-type: decimal">
<li>Removal of outliers (perceived)</li>
<li>Filtering features/metabolites with too many missing values</li>
<li>Missing value imputation</li>
<li>Drift- and/or batch correction</li>
<li>Removal of uncorrected features</li>
<li>Data normalization</li>
<li>Data transformation</li>
<li>Data scaling</li>
<li>Filtering features/metabolites via Relative Standard Deviation
(RSD)</li>
<li>Filtering features/metabolites with low variance across groups</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the default parameters</span></span>
<span><span class="va">processed_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_PreprocessingPeakData.html">perform_PreprocessingPeakData</a></span><span class="op">(</span></span>
<span>  raw_data <span class="op">=</span> <span class="va">list_from_perform_DataQualityCheck_function</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="principal-component-analysis-pca">3. Principal Component Analysis (PCA)<a class="anchor" aria-label="anchor" href="#principal-component-analysis-pca"></a>
</h3>
<p>Explore data structure and quality:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform PCA and produce a scree plot and 3 scores plots</span></span>
<span><span class="va">pca_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_PCA.html">perform_PCA</a></span><span class="op">(</span></span>
<span>  <span class="va">processed_data</span>,</span>
<span>  <span class="co">#   PC1 vs 2  Pc1 vs 3  PC2 vs 3</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate all 4 PCA plots in 1 plot</span></span>
<span><span class="fu"><a href="../reference/display_AllPlots.html">display_AllPlots</a></span><span class="op">(</span><span class="va">pca_results</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="orthogonal-partial-least-squares-discriminant-analysis-opls-da">4. Orthogonal-Partial Least Squares Discriminant Analysis
(OPLS-DA)<a class="anchor" aria-label="anchor" href="#orthogonal-partial-least-squares-discriminant-analysis-opls-da"></a>
</h3>
<p>Identify discriminating metabolites:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform OPLS-DA</span></span>
<span><span class="va">plsda_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_PLS.html">perform_PLS</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">processed_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"oplsda"</span>,</span>
<span>  arrangeLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Severe Case"</span>, <span class="st">"Less Severe Case"</span>, <span class="st">"Control"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "arrangeLevels" is suggested to be arranged where severe cases first then control at the end</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fold-change-analysis">5. Fold Change Analysis<a class="anchor" aria-label="anchor" href="#fold-change-analysis"></a>
</h3>
<p>Calculate effect sizes:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate fold changes</span></span>
<span><span class="va">fc_results</span> <span class="op">&lt;-</span> <span class="fu">calculate_fold_changes</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">processed_data</span>,</span>
<span>  arrangeLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Severe Case"</span>, <span class="st">"Less Severe Case"</span>, <span class="st">"Control"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "arrangeLevels" is suggested to be arranged where severe cases first then control at the end</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="statistical-analysis">6. Statistical Analysis<a class="anchor" aria-label="anchor" href="#statistical-analysis"></a>
</h3>
<p>Test for significant differences between groups:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform statistical tests</span></span>
<span><span class="va">stats_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_ComparativeAnalysis.html">perform_ComparativeAnalysis</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">processed_data</span>,</span>
<span>  adjust_p_method <span class="op">=</span> <span class="st">"BH"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="auroc">7. AUROC<a class="anchor" aria-label="anchor" href="#auroc"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">auroc_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_AUROC.html">perform_AUROC</a></span><span class="op">(</span></span>
<span>  data_PP <span class="op">=</span> <span class="va">processed_data</span>, <span class="co"># The list from preprocessing</span></span>
<span>  data_DR <span class="op">=</span> <span class="va">plsda_results</span>,  <span class="co"># The list from OPLS-DA</span></span>
<span>  data_FC <span class="op">=</span> <span class="va">fc_results</span>,     <span class="co"># The list from fold change analysis</span></span>
<span>  data_CA <span class="op">=</span> <span class="va">stats_results</span>,  <span class="co"># The list from statistical analysis</span></span>
<span>  arrangeLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Less Severe Case"</span>, <span class="st">"Severe Case"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># UNLIKE OPLS-DA and fold change analysis, "arrangeLevels" in AUROC is suggested to be arranged where controls first then severe cases at the end</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="regression">8. Regression<a class="anchor" aria-label="anchor" href="#regression"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regression_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perform_Regression.html">perform_Regression</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">processed_data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"enet"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># method options are "enet" for Elastic net regression</span></span>
<span><span class="co">#                    "lasso" for LASSO</span></span>
<span><span class="co">#                    "both" to perform both enet and lasso</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-data-frames-and-tables-to-excel">9. Export data frames and tables to Excel<a class="anchor" aria-label="anchor" href="#export-data-frames-and-tables-to-excel"></a>
</h3>
<p>Each item in the “list” parameter will be checked for data frames,
tibbles and the likes, that can be exported to Excel. Each item in the
list will have its own Excel workbook. Each data frame will have its own
worksheet. Long names will be shortened to match Excel’s limit.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/perform_Export2Excel.html">perform_Export2Excel</a></span><span class="op">(</span></span>
<span>  results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">processed_data</span>,</span>
<span>    <span class="va">pca_results</span>,</span>
<span>    <span class="va">plsda_results</span>,</span>
<span>    <span class="va">fc_results</span>,</span>
<span>    <span class="va">stats_results</span>,</span>
<span>    <span class="va">auroc_results</span>,</span>
<span>    <span class="va">regression_results</span></span>
<span>  <span class="op">)</span>,</span>
<span>  folder_name <span class="op">=</span> <span class="st">"Results_Folder"</span>, <span class="co"># Which folder to store the results</span></span>
<span>  file_name <span class="op">=</span> <span class="st">"Results_Export"</span> <span class="co"># Base file names of the exported data frames</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note:</span></span>
<span><span class="co"># "file_name" can accept a list of the same length as "results" to specify the file name of each list</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="export-plots-to-images">10. Export plots to images<a class="anchor" aria-label="anchor" href="#export-plots-to-images"></a>
</h3>
<p>Plots and figures are exported to PNG, JPG, etc.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/perform_ExportPlots2Image.html">perform_ExportPlots2Image</a></span><span class="op">(</span></span>
<span>  results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">processed_data</span>,</span>
<span>    <span class="va">pca_results</span>,</span>
<span>    <span class="va">plsda_results</span>,</span>
<span>    <span class="va">fc_results</span>,</span>
<span>    <span class="va">stats_results</span>,</span>
<span>    <span class="va">auroc_results</span>,</span>
<span>    <span class="va">regression_results</span></span>
<span>  <span class="op">)</span>,</span>
<span>  folder_name <span class="op">=</span> <span class="st">"Plots_Export"</span>,</span>
<span>  file_prefix <span class="op">=</span> <span class="st">"Plot"</span>,</span>
<span>  image_format <span class="op">=</span> <span class="st">"png"</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  dpi <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization">11. Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p>Create publication-ready plots:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Volcano plot</span></span>
<span><span class="fu"><a href="../reference/plot_Volcano.html">plot_Volcano</a></span><span class="op">(</span></span>
<span>  PPData <span class="op">=</span> <span class="va">processed_data</span>,</span>
<span>  FCData <span class="op">=</span> <span class="va">fc_results</span>,</span>
<span>  CAData <span class="op">=</span> <span class="va">stats_results</span>,</span>
<span>  arrangeLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Severe Case"</span>, <span class="st">"Less Severe Case"</span>, <span class="st">"Control"</span><span class="op">)</span>,</span>
<span>  fcUP <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Fold change threshold</span></span>
<span>  fcDown <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># Fold change threshold</span></span>
<span>  adjpvalue <span class="op">=</span> <span class="fl">0.05</span> <span class="co"># Adjusted p-value threshold</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="output-interpretation">Output Interpretation<a class="anchor" aria-label="anchor" href="#output-interpretation"></a>
</h2>
<div class="section level3">
<h3 id="understanding-results">Understanding Results<a class="anchor" aria-label="anchor" href="#understanding-results"></a>
</h3>
<ul>
<li>
<strong>PCA plots</strong>: Show overall data structure and
potential outliers</li>
<li>
<strong>OPLS-DA plots</strong>: Reveal group separations and
discriminating features<br>
</li>
<li>
<strong>VIP scores</strong>: Rank metabolites by importance for
group discrimination</li>
<li>
<strong>Volcano plots</strong>: Visualize both statistical
significance and biological relevance</li>
<li>
<strong>p-value distributions</strong>: Assess the quality of
statistical tests</li>
</ul>
</div>
<div class="section level3">
<h3 id="typical-workflow-results">Typical Workflow Results<a class="anchor" aria-label="anchor" href="#typical-workflow-results"></a>
</h3>
<p>After running the complete workflow, you should have:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Quality-controlled data</strong>: With missing values
handled and technical effects removed</li>
<li>
<strong>Exploratory analysis results</strong>: PCA and OPLS-DA plots
showing data structure</li>
<li>
<strong>Statistical test results</strong>: p-values and fold changes
for each metabolite</li>
<li>
<strong>Visualizations</strong>: Publication-ready plots
highlighting significant findings</li>
<li>
<strong>Biomarker candidates</strong>: List of metabolites
significantly different between groups</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="data-quality">Data Quality<a class="anchor" aria-label="anchor" href="#data-quality"></a>
</h3>
<ul>
<li>Ensure uniqueness of samples and feature names, and injection
sequences</li>
<li>Always examine raw data distributions before preprocessing</li>
<li>Check for batch effects using PCA plots</li>
<li>Validate important findings using orthogonal approaches</li>
</ul>
</div>
<div class="section level3">
<h3 id="statistical-considerations">Statistical Considerations<a class="anchor" aria-label="anchor" href="#statistical-considerations"></a>
</h3>
<ul>
<li>Consider multiple testing correction for metabolomics datasets</li>
<li>Validate biomarkers in independent datasets when possible</li>
</ul>
</div>
<div class="section level3">
<h3 id="reproducibility">Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h3>
<ul>
<li>Document all preprocessing steps and parameters</li>
<li>Use version control for analysis scripts</li>
<li>Provide session information in reports</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="common-issues-and-solutions">Common Issues and Solutions<a class="anchor" aria-label="anchor" href="#common-issues-and-solutions"></a>
</h2>
<div class="section level3">
<h3 id="missing-values">Missing Values<a class="anchor" aria-label="anchor" href="#missing-values"></a>
</h3>
<ul>
<li>
<strong>Problem</strong>: High proportion of missing values</li>
<li>
<strong>Solution</strong>: Adjust missing value thresholds or use
specialized imputation methods</li>
</ul>
</div>
<div class="section level3">
<h3 id="batch-effects">Batch Effects<a class="anchor" aria-label="anchor" href="#batch-effects"></a>
</h3>
<ul>
<li>
<strong>Problem</strong>: Technical variation between batches</li>
<li>
<strong>Solution</strong>: Include batch information and apply
correction methods</li>
</ul>
</div>
<div class="section level3">
<h3 id="non-normal-data">Non-normal Data<a class="anchor" aria-label="anchor" href="#non-normal-data"></a>
</h3>
<ul>
<li>
<strong>Problem</strong>: Highly skewed metabolite
distributions</li>
<li>
<strong>Solution</strong>: Apply appropriate transformations (log10,
vsn) or use non-parametric tests</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="getting-help">Getting Help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h2>
<p>For questions about MetaboStatR: - Check the function documentation:
<code>?function_name</code> - Browse additional vignettes for specific
topics - Report issues on GitHub: <a href="https://github.com/jllcalorio/MetaboStatR/issues" class="external-link uri">https://github.com/jllcalorio/MetaboStatR/issues</a> -
Contact: <a href="mailto:jllcalorio@gmail.com" class="email">jllcalorio@gmail.com</a></p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14 ucrt)</span></span>
<span><span class="co">#&gt; Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">#&gt; Running under: Windows 11 x64 (build 26100)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] LC_COLLATE=English_Philippines.utf8  LC_CTYPE=English_Philippines.utf8   </span></span>
<span><span class="co">#&gt; [3] LC_MONETARY=English_Philippines.utf8 LC_NUMERIC=C                        </span></span>
<span><span class="co">#&gt; [5] LC_TIME=English_Philippines.utf8    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Asia/Manila</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] digest_0.6.37     desc_1.4.3        R6_2.6.1          fastmap_1.2.0    </span></span>
<span><span class="co">#&gt;  [5] xfun_0.52         cachem_1.1.0      knitr_1.50        htmltools_0.5.8.1</span></span>
<span><span class="co">#&gt;  [9] rmarkdown_2.29    lifecycle_1.0.4   cli_3.6.5         sass_0.4.10      </span></span>
<span><span class="co">#&gt; [13] pkgdown_2.1.3     textshaping_1.0.1 jquerylib_0.1.4   systemfonts_1.2.3</span></span>
<span><span class="co">#&gt; [17] compiler_4.4.1    rstudioapi_0.17.1 tools_4.4.1       ragg_1.4.0       </span></span>
<span><span class="co">#&gt; [21] bslib_0.9.0       evaluate_1.0.4    yaml_2.3.10       jsonlite_2.0.0   </span></span>
<span><span class="co">#&gt; [25] rlang_1.1.6       fs_1.6.6          htmlwidgets_1.6.4</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Lennon Calorio.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
