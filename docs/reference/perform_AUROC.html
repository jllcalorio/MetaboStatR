<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform Area Under the Receiver Operating Characteristic Curve Analysis — perform_AUROC • MetaboStatR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform Area Under the Receiver Operating Characteristic Curve Analysis — perform_AUROC"><meta property="og:description" content="Performs comprehensive Area Under the Receiver Operating Characteristic (AUROC)
analysis for metabolomics data. This function integrates results from data
preprocessing, dimension reduction (OPLS-DA), fold change analysis, and
comparative analysis to identify and visualize discriminative metabolic features
between different groups. The function automatically filters features based on
Variable Importance in Projection (VIP) scores, fold change thresholds, and
statistical significance, then generates ROC curves for the most discriminative features."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboStatR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to MetaboStatR</a>
    </li>
    <li>
      <a href="../articles/metabolomics-workflow.html">Complete Metabolomics Analysis Workflow</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform Area Under the Receiver Operating Characteristic Curve Analysis</h1>

    <div class="hidden name"><code>perform_AUROC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs comprehensive Area Under the Receiver Operating Characteristic (AUROC)
analysis for metabolomics data. This function integrates results from data
preprocessing, dimension reduction (OPLS-DA), fold change analysis, and
comparative analysis to identify and visualize discriminative metabolic features
between different groups. The function automatically filters features based on
Variable Importance in Projection (VIP) scores, fold change thresholds, and
statistical significance, then generates ROC curves for the most discriminative features.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perform_AUROC</span><span class="op">(</span></span>
<span>  <span class="va">data_PP</span>,</span>
<span>  <span class="va">data_DR</span>,</span>
<span>  <span class="va">data_FC</span>,</span>
<span>  <span class="va">data_CA</span>,</span>
<span>  arrangeLevels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  VIPmin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fcUP <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  fcDown <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  adjpvalue <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  plot_iden_met <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  confidence_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  min_group_size <span class="op">=</span> <span class="fl">3L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data-pp">data_PP<a class="anchor" aria-label="anchor" href="#arg-data-pp"></a></dt>
<dd><p>List. Results from the <code>performPreprocessingPeakData</code> function.
Must contain <code>$Metadata</code> with <code>$Group</code> column and
<code>$data_scaledPCA_rsdFiltered_varFiltered</code> matrix.</p></dd>


<dt id="arg-data-dr">data_DR<a class="anchor" aria-label="anchor" href="#arg-data-dr"></a></dt>
<dd><p>List. Results from the <code>performDimensionReduction</code> function
(OPLS-DA). Must contain VIP score data frames with naming pattern
<code>data_VIPScores_[group1] vs. [group2]</code>.</p></dd>


<dt id="arg-data-fc">data_FC<a class="anchor" aria-label="anchor" href="#arg-data-fc"></a></dt>
<dd><p>List. Results from the <code>performFoldChange</code> function. Must
contain fold change data frames with naming pattern
<code>data_combined_[group1] vs. [group2]</code>.</p></dd>


<dt id="arg-data-ca">data_CA<a class="anchor" aria-label="anchor" href="#arg-data-ca"></a></dt>
<dd><p>List. Results from the <code>performComparativeAnalysis</code> function.
Must contain <code>$results</code> data frame with adjusted p-values.</p></dd>


<dt id="arg-arrangelevels">arrangeLevels<a class="anchor" aria-label="anchor" href="#arg-arrangelevels"></a></dt>
<dd><p>Character vector or NULL. Specifies the order of groups
for analysis (e.g., <code>c("Control", "Case1", "Case2")</code>). When NULL,
groups are sorted alphabetically. It is recommended to arrange from least
severe to most severe condition (e.g., "Control", "Mild", "Severe").</p></dd>


<dt id="arg-vipmin">VIPmin<a class="anchor" aria-label="anchor" href="#arg-vipmin"></a></dt>
<dd><p>Numeric. Minimum Variable Importance in Projection (VIP) score
threshold for feature selection. Features with VIP &lt; VIPmin are excluded.
Default: 1.0.</p></dd>


<dt id="arg-fcup">fcUP<a class="anchor" aria-label="anchor" href="#arg-fcup"></a></dt>
<dd><p>Numeric. Minimum fold change threshold for up-regulated features.
Features with fold change &gt;= fcUP are considered up-regulated. Default: 2.0.</p></dd>


<dt id="arg-fcdown">fcDown<a class="anchor" aria-label="anchor" href="#arg-fcdown"></a></dt>
<dd><p>Numeric. Maximum fold change threshold for down-regulated features.
Features with fold change &lt;= fcDown are considered down-regulated. Default: 0.5.</p></dd>


<dt id="arg-adjpvalue">adjpvalue<a class="anchor" aria-label="anchor" href="#arg-adjpvalue"></a></dt>
<dd><p>Numeric. Adjusted p-value threshold for statistical significance.
Features with adjusted p-value &gt;= adjpvalue are excluded. Default: 0.05.</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>Character. Direction parameter for ROC analysis. Options:</p><ul><li><p><code>"auto"</code>: Automatically determines optimal direction</p></li>
<li><p><code>"&gt;"</code>: Use when predictor values for control group &gt; case group</p></li>
<li><p><code>"&lt;"</code>: Use when predictor values for control group &lt; case group</p></li>
</ul><p>See <code><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></code> for details. Default: "auto".</p></dd>


<dt id="arg-top-n">top_n<a class="anchor" aria-label="anchor" href="#arg-top-n"></a></dt>
<dd><p>Integer. Number of top features (by AUC) to display in ROC plots.
Must be positive. Default: 5.</p></dd>


<dt id="arg-plot-iden-met">plot_iden_met<a class="anchor" aria-label="anchor" href="#arg-plot-iden-met"></a></dt>
<dd><p>Character vector or NULL. Specific metabolite names to plot
individually. When provided, generates separate ROC plots for each specified
metabolite regardless of filtering criteria. Default: NULL.</p></dd>


<dt id="arg-confidence-level">confidence_level<a class="anchor" aria-label="anchor" href="#arg-confidence-level"></a></dt>
<dd><p>Numeric. Confidence level for AUC confidence intervals.
Must be between 0 and 1. Default: 0.95.</p></dd>


<dt id="arg-min-group-size">min_group_size<a class="anchor" aria-label="anchor" href="#arg-min-group-size"></a></dt>
<dd><p>Integer. Minimum number of samples required per group
for ROC analysis. Default: 3.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing the following components:</p><ul><li><p><code>FunctionOrigin</code>: Character indicating the source function</p></li>
<li><p><code>data_Merged_[comparison]</code>: Merged data frames for each group comparison</p></li>
<li><p><code>data_Filtered_[comparison]</code>: Filtered data matrices for each comparison</p></li>
<li><p><code>data_results_[comparison]</code>: AUROC results data frames</p></li>
<li><p><code>plots</code>: List of combined ROC plots for top features</p></li>
<li><p><code>plots_identifiedMetabolites</code>: Individual plots for specified metabolites (if requested)</p></li>
<li><p><code>summary</code>: Overall summary statistics</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function performs the following steps:</p><ol><li><p>Validates input data and parameters</p></li>
<li><p>Excludes quality control (QC) samples</p></li>
<li><p>Generates all possible pairwise group combinations</p></li>
<li><p>For each comparison, merges VIP, fold change, and statistical data</p></li>
<li><p>Filters features based on specified thresholds</p></li>
<li><p>Computes ROC curves and AUC values with confidence intervals</p></li>
<li><p>Generates publication-ready plots</p></li>
<li><p>Optionally creates individual plots for specified metabolites</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">roc</a></code>, <code><a href="https://rdrr.io/pkg/pROC/man/auc.html" class="external-link">auc</a></code>, <code><a href="https://rdrr.io/pkg/pROC/man/ci.html" class="external-link">ci</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>John Lennon L. Calorio</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="va">auroc_results</span> <span class="op">&lt;-</span> <span class="fu">perform_AUROC</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data_PP <span class="op">=</span> <span class="va">preprocessing_results</span>,</span></span>
<span class="r-in"><span>  data_DR <span class="op">=</span> <span class="va">dimension_reduction_results</span>,</span></span>
<span class="r-in"><span>  data_FC <span class="op">=</span> <span class="va">fold_change_results</span>,</span></span>
<span class="r-in"><span>  data_CA <span class="op">=</span> <span class="va">comparative_analysis_results</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Advanced usage with custom parameters</span></span></span>
<span class="r-in"><span><span class="va">auroc_results</span> <span class="op">&lt;-</span> <span class="fu">perform_AUROC</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data_PP <span class="op">=</span> <span class="va">preprocessing_results</span>,</span></span>
<span class="r-in"><span>  data_DR <span class="op">=</span> <span class="va">dimension_reduction_results</span>,</span></span>
<span class="r-in"><span>  data_FC <span class="op">=</span> <span class="va">fold_change_results</span>,</span></span>
<span class="r-in"><span>  data_CA <span class="op">=</span> <span class="va">comparative_analysis_results</span>,</span></span>
<span class="r-in"><span>  arrangeLevels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Mild"</span>, <span class="st">"Severe"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  VIPmin <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  fcUP <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>  fcDown <span class="op">=</span> <span class="fl">0.67</span>,</span></span>
<span class="r-in"><span>  adjpvalue <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>  top_n <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  plot_iden_met <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metabolite1"</span>, <span class="st">"Metabolite2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by John Lennon Calorio.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

