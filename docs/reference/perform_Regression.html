<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform LASSO and Elastic Net Regression with Cross-Validation — perform_Regression • MetaboStatR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform LASSO and Elastic Net Regression with Cross-Validation — perform_Regression"><meta property="og:description" content="This function performs regularized regression analysis using LASSO (Least Absolute
Shrinkage and Selection Operator) and/or Elastic Net regression methods. Both methods
are regularization techniques that prevent overfitting by adding penalty terms to the
loss function. LASSO uses L1 regularization for feature selection by shrinking
coefficients to zero, while Elastic Net combines L1 and L2 penalties to handle
multicollinearity and perform simultaneous feature selection. The function supports
both binary and multinomial classification tasks with comprehensive model evaluation
and result reporting."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboStatR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to MetaboStatR</a>
    </li>
    <li>
      <a href="../articles/metabolomics-workflow.html">Complete Metabolomics Analysis Workflow</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform LASSO and Elastic Net Regression with Cross-Validation</h1>

    <div class="hidden name"><code>perform_Regression.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs regularized regression analysis using LASSO (Least Absolute
Shrinkage and Selection Operator) and/or Elastic Net regression methods. Both methods
are regularization techniques that prevent overfitting by adding penalty terms to the
loss function. LASSO uses L1 regularization for feature selection by shrinking
coefficients to zero, while Elastic Net combines L1 and L2 penalties to handle
multicollinearity and perform simultaneous feature selection. The function supports
both binary and multinomial classification tasks with comprehensive model evaluation
and result reporting.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perform_Regression</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"enet"</span>,</span>
<span>  specify_response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  train_percent <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda <span class="op">=</span> <span class="st">"1se"</span>,</span>
<span>  remember <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cv_folds <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A list object containing preprocessed data. Must be the output from the
<code>perform_PreprocessingPeakData</code> function, containing the following elements:</p><ul><li><p><code>FunctionOrigin</code>: Character string indicating data source</p></li>
<li><p><code>Metadata</code>: Data frame with sample metadata including Group column</p></li>
<li><p><code>data_scaledPCA_rsdFiltered_varFiltered</code>: Matrix of preprocessed features</p></li>
</ul></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character vector specifying regression method(s) to perform. Options:</p><ul><li><p><code>"lasso"</code>: LASSO regression only (L1 penalty, alpha = 1)</p></li>
<li><p><code>"enet"</code>: Elastic Net regression only (L1+L2 penalty, alpha = 0.5)</p></li>
<li><p><code>c("lasso", "enet")</code>: Both methods (recommended for comparison)</p></li>
</ul><p>Default: <code>"enet"</code></p></dd>


<dt id="arg-specify-response">specify_response<a class="anchor" aria-label="anchor" href="#arg-specify-response"></a></dt>
<dd><p>Character string specifying the response variable column name.
If <code>NULL</code>, uses the Group column from metadata. Default: <code>NULL</code></p></dd>


<dt id="arg-train-percent">train_percent<a class="anchor" aria-label="anchor" href="#arg-train-percent"></a></dt>
<dd><p>Numeric value between 1 and 99 specifying the percentage of data
to use for training. Remaining data used for testing. Default: <code>80</code></p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>Character string specifying the reference level for the response variable.
If <code>NULL</code>, uses the first factor level alphabetically. Default: <code>NULL</code></p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Character string specifying lambda selection criterion:</p><ul><li><p><code>"1se"</code>: Lambda within one standard error of minimum (conservative, fewer features)</p></li>
<li><p><code>"min"</code>: Lambda that minimizes cross-validation error (aggressive, more features)</p></li>
</ul><p>Default: <code>"1se"</code></p></dd>


<dt id="arg-remember">remember<a class="anchor" aria-label="anchor" href="#arg-remember"></a></dt>
<dd><p>Numeric value for reproducible results. Sets random seed using
<code>set.seed(remember)</code>. If <code>NULL</code>, no seed is set. Default: <code>NULL</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical indicating whether to print progress messages and results
to console. Default: <code>TRUE</code></p></dd>


<dt id="arg-cv-folds">cv_folds<a class="anchor" aria-label="anchor" href="#arg-cv-folds"></a></dt>
<dd><p>Integer specifying number of cross-validation folds for model
selection. Must be between 3 and 20. Default: <code>10</code></p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical indicating whether to use parallel processing for
cross-validation. Default: <code>FALSE</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing regression results with the following structure:</p><dl><dt><code>FunctionOrigin</code></dt>
<dd><p>Character string identifying the source function</p></dd>

<dt><code>ModelSummary</code></dt>
<dd><p>Data frame summarizing model performance metrics</p></dd>

<dt><code>DataSplit</code></dt>
<dd><p>List containing training/testing data split information</p></dd>

<dt><code>LASSO_Results</code></dt>
<dd><p>List of LASSO results (if method includes "lasso")</p></dd>

<dt><code>ElasticNet_Results</code></dt>
<dd><p>List of Elastic Net results (if method includes "enet")</p></dd>

<dt><code>ComparisonSummary</code></dt>
<dd><p>Data frame comparing methods (if both performed)</p></dd>


</dl><p>Each method-specific results list contains:</p><ul><li><p><code>Model</code>: Fitted cv.glmnet object</p></li>
<li><p><code>Predictions</code>: Data frame with actual vs predicted values</p></li>
<li><p><code>ConfusionMatrix</code>: Complete confusion matrix object</p></li>
<li><p><code>Performance</code>: Data frame with accuracy, sensitivity, specificity, etc.</p></li>
<li><p><code>Coefficients</code>: Data frame with non-zero coefficients and odds ratios</p></li>
<li><p><code>Lambda</code>: Selected lambda value</p></li>
<li><p><code>Alpha</code>: Alpha parameter used</p></li>
<li><p><code>ReferenceLevel</code>: Reference level for classification</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>Perform Regularized Regression Analysis</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></code>, <code><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html" class="external-link">confusionMatrix</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>John Lennon L. Calorio</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load required libraries</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu" class="external-link">glmnet</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform both LASSO and Elastic Net regression</span></span></span>
<span class="r-in"><span><span class="va">regression_results</span> <span class="op">&lt;-</span> <span class="fu">perform_Regression</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">preprocessed_data</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lasso"</span>, <span class="st">"enet"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  train_percent <span class="op">=</span> <span class="fl">75</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="st">"1se"</span>,</span></span>
<span class="r-in"><span>  remember <span class="op">=</span> <span class="fl">123</span>,</span></span>
<span class="r-in"><span>  cv_folds <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View model comparison</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">regression_results</span><span class="op">$</span><span class="va">ModelSummary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">regression_results</span><span class="op">$</span><span class="va">ComparisonSummary</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access LASSO results</span></span></span>
<span class="r-in"><span><span class="va">lasso_coef</span> <span class="op">&lt;-</span> <span class="va">regression_results</span><span class="op">$</span><span class="va">LASSO_Results</span><span class="op">$</span><span class="va">Coefficients</span></span></span>
<span class="r-in"><span><span class="va">lasso_perf</span> <span class="op">&lt;-</span> <span class="va">regression_results</span><span class="op">$</span><span class="va">LASSO_Results</span><span class="op">$</span><span class="va">Performance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access Elastic Net results</span></span></span>
<span class="r-in"><span><span class="va">enet_coef</span> <span class="op">&lt;-</span> <span class="va">regression_results</span><span class="op">$</span><span class="va">ElasticNet_Results</span><span class="op">$</span><span class="va">Coefficients</span></span></span>
<span class="r-in"><span><span class="va">enet_perf</span> <span class="op">&lt;-</span> <span class="va">regression_results</span><span class="op">$</span><span class="va">ElasticNet_Results</span><span class="op">$</span><span class="va">Performance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View confusion matrices</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">regression_results</span><span class="op">$</span><span class="va">LASSO_Results</span><span class="op">$</span><span class="va">ConfusionMatrix</span><span class="op">$</span><span class="va">table</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">regression_results</span><span class="op">$</span><span class="va">ElasticNet_Results</span><span class="op">$</span><span class="va">ConfusionMatrix</span><span class="op">$</span><span class="va">table</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by John Lennon Calorio.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

