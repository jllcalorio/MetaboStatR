<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Export Data Frames to Excel Workbook — perform_Export2Excel • MetaboStatR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Export Data Frames to Excel Workbook — perform_Export2Excel"><meta property="og:description" content="Exports data frames from named lists or multiple lists to multi-sheet Excel workbooks.
The function automatically detects data frames and tibbles within the input, creates
appropriately named worksheets, and handles various edge cases including sheet name
length restrictions, duplicate names, and invalid characters. Each data frame becomes
a separate worksheet in the output Excel file. The function can accept either a single
named list or multiple lists, and will create separate Excel files for each list when
multiple file names are provided."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MetaboStatR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to MetaboStatR</a>
    </li>
    <li>
      <a href="../articles/metabolomics-workflow.html">Complete Metabolomics Analysis Workflow</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Export Data Frames to Excel Workbook</h1>

    <div class="hidden name"><code>perform_Export2Excel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Exports data frames from named lists or multiple lists to multi-sheet Excel workbooks.
The function automatically detects data frames and tibbles within the input, creates
appropriately named worksheets, and handles various edge cases including sheet name
length restrictions, duplicate names, and invalid characters. Each data frame becomes
a separate worksheet in the output Excel file. The function can accept either a single
named list or multiple lists, and will create separate Excel files for each list when
multiple file names are provided.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perform_Export2Excel</span><span class="op">(</span></span>
<span>  <span class="va">results</span>,</span>
<span>  folder_name <span class="op">=</span> <span class="st">"Results_Folder"</span>,</span>
<span>  file_name <span class="op">=</span> <span class="st">"Results_Export"</span>,</span>
<span>  include_timestamp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  freeze_first_row <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  auto_width <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_sheets <span class="op">=</span> <span class="fl">255</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-results">results<a class="anchor" aria-label="anchor" href="#arg-results"></a></dt>
<dd><p>Either a named list containing data frames/tibbles, or multiple lists
that can be passed as: results = list1, or results = c(list1, list2),
or results = list(list1, list2, list3). Only data frames and tibbles will be exported,
but empty data frames will still be included as worksheets.</p></dd>


<dt id="arg-folder-name">folder_name<a class="anchor" aria-label="anchor" href="#arg-folder-name"></a></dt>
<dd><p>Character string specifying the folder name where the Excel file(s)
will be saved. The folder will be created if it doesn't exist. Default is "Results_Folder".</p></dd>


<dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>Character vector specifying the base name(s) of the Excel file(s) (without
extension). If a single name is provided, it will be used for all lists. If multiple names
are provided, each list will get its own file with the corresponding name. A timestamp
will be automatically appended. Default is "Results_Export".</p></dd>


<dt id="arg-include-timestamp">include_timestamp<a class="anchor" aria-label="anchor" href="#arg-include-timestamp"></a></dt>
<dd><p>Logical indicating whether to include a timestamp in the
filename(s). Default is TRUE.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Logical indicating whether to overwrite existing files. If FALSE and file
exists, an error will be thrown. If TRUE but file is currently open in Excel, the function
will detect this and provide a specific error message. Default is TRUE.</p></dd>


<dt id="arg-row-names">row_names<a class="anchor" aria-label="anchor" href="#arg-row-names"></a></dt>
<dd><p>Logical indicating whether to include row names in the Excel output.
Default is TRUE.</p></dd>


<dt id="arg-freeze-first-row">freeze_first_row<a class="anchor" aria-label="anchor" href="#arg-freeze-first-row"></a></dt>
<dd><p>Logical indicating whether to freeze the first row (headers)
in each worksheet. Default is TRUE.</p></dd>


<dt id="arg-auto-width">auto_width<a class="anchor" aria-label="anchor" href="#arg-auto-width"></a></dt>
<dd><p>Logical indicating whether to auto-adjust column widths. Default is TRUE.</p></dd>


<dt id="arg-max-sheets">max_sheets<a class="anchor" aria-label="anchor" href="#arg-max-sheets"></a></dt>
<dd><p>Integer specifying maximum number of worksheets to create per file.
Default is 255 (Excel limit).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Invisibly returns a character vector of full paths to the created Excel file(s).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function performs the following operations:</p><ul><li><p>Validates and processes input parameters (single list or multiple lists)</p></li>
<li><p>Processes multiple lists and creates separate files when multiple file names provided</p></li>
<li><p>Filters the list(s) to include only data frames and tibbles (including empty ones)</p></li>
<li><p>Sanitizes sheet names to comply with Excel naming conventions</p></li>
<li><p>Creates multi-sheet Excel workbook(s) with formatted headers</p></li>
<li><p>Applies optional formatting (frozen headers, auto-width columns)</p></li>
<li><p>Saves the workbook(s) with optional timestamps</p></li>
<li><p>Detects if Excel files are currently open and provides specific error messages</p></li>
</ul><p>Multiple list and file handling:</p><ul><li><p>If single file_name provided: all lists merged into one Excel file</p></li>
<li><p>If multiple file_names provided: each list becomes a separate Excel file</p></li>
<li><p>If more lists than file names: remaining lists use the last file name with suffixes</p></li>
<li><p>Empty data frames are included as worksheets (preserving structure information)</p></li>
</ul><p>Sheet names are automatically sanitized to:</p><ul><li><p>Remove or replace invalid characters</p></li>
<li><p>Ensure uniqueness by appending numbers to duplicates</p></li>
<li><p>Truncate names exceeding 31 characters (Excel limit)</p></li>
<li><p>Preserve readability by intelligently shortening names</p></li>
</ul></div>
    <div id="dependencies">
    <h2>Dependencies</h2>


<p>Requires the <code>openxlsx</code> package for Excel file operations.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/openxlsx/man/createWorkbook.html" class="external-link">createWorkbook</a></code>, <code><a href="https://rdrr.io/pkg/openxlsx/man/addWorksheet.html" class="external-link">addWorksheet</a></code>,
<code><a href="https://rdrr.io/pkg/openxlsx/man/writeData.html" class="external-link">writeData</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>John Lennon L. Calorio</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create sample data</span></span></span>
<span class="r-in"><span><span class="va">list1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  summary_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  raw_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  empty_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># This will still be included</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">list2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  processed_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, b <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  metadata <span class="op">=</span> <span class="st">"This will be ignored"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">list3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  final_results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>, category <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method 1: Single list, single file</span></span></span>
<span class="r-in"><span><span class="fu">perform_Export2Excel</span><span class="op">(</span>results <span class="op">=</span> <span class="va">list1</span>, file_name <span class="op">=</span> <span class="st">"Analysis_Results"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method 2: Multiple lists, single file (all merged)</span></span></span>
<span class="r-in"><span><span class="fu">perform_Export2Excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">list1</span>, <span class="va">list2</span>, <span class="va">list3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  file_name <span class="op">=</span> <span class="st">"Combined_Analysis"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method 3: Multiple lists, multiple files (separate files)</span></span></span>
<span class="r-in"><span><span class="fu">perform_Export2Excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">list1</span>, <span class="va">list2</span>, <span class="va">list3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Analysis"</span>, <span class="st">"Processing"</span>, <span class="st">"Final_Results"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Method 4: Multiple lists, partial file names</span></span></span>
<span class="r-in"><span><span class="fu">perform_Export2Excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">list1</span>, <span class="va">list2</span>, <span class="va">list3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Primary_Analysis"</span>, <span class="st">"Secondary_Analysis"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># list3 will use "Secondary_Analysis_2"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Advanced usage with custom options</span></span></span>
<span class="r-in"><span><span class="fu">perform_Export2Excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  results <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">list1</span>, <span class="va">list2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  folder_name <span class="op">=</span> <span class="st">"Analysis_Results"</span>,</span></span>
<span class="r-in"><span>  file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dataset_A"</span>, <span class="st">"Dataset_B"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  include_timestamp <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  row_names <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  freeze_first_row <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  auto_width <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  max_sheets <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by John Lennon Calorio.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

