% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_ComparativeAnalysis.R
\name{perform_ComparativeAnalysis2}
\alias{perform_ComparativeAnalysis2}
\title{Perform Comparative Statistical Analysis on Preprocessed Metabolomics Data}
\usage{
perform_ComparativeAnalysis2(
  data,
  adjust_p_method = "BH",
  sort_p = TRUE,
  paired = FALSE,
  plot_metabolites = NULL,
  alpha = 0.05,
  min_group_size = 3,
  verbose = FALSE
)
}
\arguments{
\item{data}{List. Output from \code{perform_PreprocessingPeakData} function containing:
\itemize{
\item \code{data_scaledPCA_rsdFiltered_varFiltered}: Numeric matrix of processed metabolite data
\item \code{Metadata}: Data frame with sample metadata including 'Group' column
}}

\item{adjust_p_method}{Character. Method for p-value adjustment. Default is "BH".
Options include:
\itemize{
\item "holm": Holm (1979) - Controls family-wise error rate
\item "hochberg": Hochberg (1988) - Less conservative than Bonferroni
\item "hommel": Hommel (1988) - More powerful than Hochberg
\item "bonferroni": Classical Bonferroni correction
\item "BH": Benjamini & Hochberg (1995) - Controls false discovery rate
\item "BY": Benjamini & Yekutieli (2001) - More conservative FDR control
\item "fdr": Alias for "BH"
\item "none": No adjustment
}}

\item{sort_p}{Logical. If \code{TRUE} (default), results are sorted by adjusted p-values
in ascending order.}

\item{paired}{Logical. If \code{TRUE}, performs paired sample tests. Default is \code{FALSE}.
Note: Requires equal group sizes for multi-group comparisons.}

\item{plot_metabolites}{Character vector. Names of metabolites to visualize. If provided,
generates statistical plots using \code{ggstatsplot}. Default is \code{NULL} (no plots).}

\item{alpha}{Numeric. Significance threshold for assumption tests. Default is 0.05.}

\item{min_group_size}{Integer. Minimum required sample size per group. Default is 3.}

\item{verbose}{Logical. If \code{TRUE}, prints detailed progress information. Default is \code{FALSE}.}
}
\value{
List containing:
\itemize{
\item \code{results}: Data frame with statistical test results for each metabolite
\item \code{plots}: List of ggplot objects (if \code{plot_metabolites} specified)
\item \code{summary}: Summary statistics of the analysis
\item \code{assumptions}: Results of assumption tests
\item \code{metadata}: Analysis metadata and parameters used
}
}
\description{
Conducts comprehensive comparative statistical analysis on preprocessed metabolomics data.
The function automatically selects appropriate statistical tests based on data characteristics
including normality, variance homogeneity, and sample independence. Supports both two-group
and multi-group comparisons with parametric and non-parametric alternatives.
}
\details{
The function performs the following workflow:
\enumerate{
\item Validates input data structure and parameters
\item Removes quality control samples from analysis
\item Tests statistical assumptions (normality, variance homogeneity)
\item Selects appropriate statistical tests automatically
\item Applies multiple comparison corrections
\item Generates optional visualization plots
}

For two-group comparisons, the function chooses between:
\itemize{
\item Paired/Independent t-test (parametric)
\item Welch's t-test (unequal variances)
\item Mann-Whitney U test (non-parametric)
\item Wilcoxon signed-rank test (paired non-parametric)
}

For multi-group comparisons:
\itemize{
\item One-way ANOVA (parametric)
\item Repeated measures ANOVA (paired)
\item Kruskal-Wallis test (non-parametric)
}
}
\examples{
\dontrun{
# Basic two-group comparison
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  adjust_p_method = "BH"
)

# Paired comparison with plots
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  paired = TRUE,
  plot_metabolites = c("metabolite_1", "metabolite_2"),
  verbose = TRUE
)

# Multi-group comparison with strict correction
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  adjust_p_method = "bonferroni",
  sort_p = TRUE
)
}

}
\seealso{
\code{\link{perform_PreprocessingPeakData}}, \code{\link[stats]{t.test}},
\code{\link[stats]{aov}}, \code{\link[ggstatsplot]{ggbetweenstats}}
}
\author{
Your Name
}
