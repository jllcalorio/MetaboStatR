% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_PCA.R
\name{perform_PCA}
\alias{perform_PCA}
\title{Perform Principal Component Analysis (PCA)}
\usage{
perform_PCA(
  data,
  scorePC = list(c(1, 2), c(1, 3), c(2, 3)),
  includeQC = FALSE,
  arrangeLevels = NULL,
  scoresEllipse = TRUE,
  scoresTitle = NULL,
  scoresLegend = NULL,
  includeScree = TRUE,
  screeWhat = c("variance", "eigenvalue")[1],
  screeType = c("bar", "line", "both")[3],
  screeTitle = "Scree Plot",
  screeMaxPC = NULL,
  screeShowValues = TRUE,
  screeShowCumulative = FALSE
)
}
\arguments{
\item{data}{List. This list must be a result from the \code{performPreprocessingPeakData} function.}

\item{scorePC}{List. A list of 2-element numeric vectors, where each vector specifies
the principal components to plot. For example: list(c(1,2), c(1,3), c(2,3))
will generate 3 plots: PC1 vs PC2, PC1 vs PC3, and PC2 vs PC3.}

\item{includeQC}{Boolean. If \code{TRUE}, includes QC (Quality Control) samples in the analysis and plots.
If \code{FALSE}, uses only biological samples (BS). Defaults to \code{FALSE}.}

\item{arrangeLevels}{Vector. Determines how the groups will be arranged.
The format could be "c('group1', 'group2', ...)". Defaults to \code{NULL} which
sorts the groups in alphabetical order.}

\item{scoresEllipse}{Boolean. If \code{TRUE} (default), adds an ellipse in the scores plot.}

\item{scoresTitle}{String or Vector. The scores plot title(s). Can be a single string
(applied to all plots) or a vector of strings (one for each plot). If \code{NULL},
defaults to "PCA Scores Plot (PC{i} vs PC{j})".}

\item{scoresLegend}{String. The title in the legend section of the scores plot.
Defaults to \code{NULL} which means no legend title.}

\item{includeScree}{Boolean. If \code{TRUE}, generates a scree plot in addition to scores plots.
Defaults to \code{TRUE}.}

\item{screeWhat}{Character. What to plot in the scree plot: "variance" or "eigenvalue".
Defaults to "variance".}

\item{screeType}{Character. Type of scree plot: "bar", "line", or "both".
Defaults to "both".}

\item{screeTitle}{Character. Title for the scree plot. Defaults to "Scree Plot".}

\item{screeMaxPC}{Integer. Maximum number of PCs to show in scree plot.
If NULL, shows all available PCs up to 20. Defaults to \code{NULL}.}

\item{screeShowValues}{Boolean. If \code{TRUE}, shows variance/eigenvalue values on top of bars
and removes y-axis labels. Defaults to \code{TRUE}.}

\item{screeShowCumulative}{Boolean. If \code{TRUE}, shows cumulative variance explained
on top of the scree plot. Only works when screeWhat="variance". Defaults to \code{FALSE}.}
}
\value{
Returns a list containing:
\itemize{
\item plots: A list of ggplot objects, one for each PC combination
\item scree_plot: A ggplot object for the scree plot (if includeScree is TRUE)
\item plot_info: A data frame with information about each plot (PC combinations, variance explained)
\item pca_results: The PCA results object
\item data_used: The data matrix used for PCA
\item variance_explained: Vector of variance explained by each PC
\item eigenvalues: Vector of eigenvalues for each PC
}
}
\description{
This function performs PCA and generates multiple scores plots at once based on a list of
principal component combinations, plus an optional scree plot. Each combination in the list
will produce a separate scores plot.
}
\examples{
\dontrun{
# Generate 3 different scores plots plus scree plot
multi_plots <- perform_PCA(
  data = data_from_performPreprocessingPeakData_function,
  scorePC = list(c(1,2), c(1,3), c(2,3)),
  includeQC = FALSE,
  scoresEllipse = TRUE,
  includeScree = TRUE,
  screeWhat = "variance",
  screeType = "both"
)

# Access individual plots
plot1 <- multi_plots$plots[[1]]  # PC1 vs PC2
plot2 <- multi_plots$plots[[2]]  # PC1 vs PC3
scree <- multi_plots$scree_plot  # Scree plot

# Display all plots
displayAllPlots(multi_plots, include_scree = TRUE)
}
}
