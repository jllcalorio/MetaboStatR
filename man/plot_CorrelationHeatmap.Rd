% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_CorrelationHeatmap.R
\name{plot_CorrelationHeatmap}
\alias{plot_CorrelationHeatmap}
\title{Plot Correlation and Hierarchical Clustering Heatmaps}
\usage{
plot_CorrelationHeatmap(
  data,
  method = "pearson",
  plot_top_n = 1000,
  plot_what = "Features",
  plot_type = "correlation",
  show_rownames = TRUE,
  show_colnames = TRUE,
  clustering_distance_rows = "euclidean",
  clustering_distance_cols = "euclidean",
  clustering_method = "ward.D",
  significance_threshold = 0.05,
  color_palette = c("blue", "white", "red"),
  fontsize_main = 12,
  fontsize_labels = 8
)
}
\arguments{
\item{data}{A list object containing preprocessed data. Must include a component
named \code{data_scaledPCA_varFiltered} or \code{data_scaledPCA_merged} (typically output from
\code{perform_PreprocessingPeakData} function). The function automatically selects
the appropriate data source based on \code{data$Parameters$auto_merge_replicates}.}

\item{method}{Character string specifying the correlation method. One of:
\itemize{
\item \code{"pearson"}: Pearson product-moment correlation (default)
\item \code{"spearman"}: Spearman's rank correlation
\item \code{"kendall"}: Kendall's tau correlation
}}

\item{plot_top_n}{Positive integer specifying the number of top variable
features/samples to include in the plot. Must be > 0. Default is 1000.}

\item{plot_what}{Character string specifying what to plot. One of:
\itemize{
\item \code{"Features"}: Plot correlations between features (default)
\item \code{"Samples"}: Plot correlations between samples
}}

\item{plot_type}{Character string specifying the plot type. One of:
\itemize{
\item \code{"correlation"}: Correlation heatmap with significance masking (default)
\item \code{"hierarchical"}: Hierarchical clustering heatmap of raw values
}}

\item{show_rownames}{Logical. Whether to display row names. Default is \code{TRUE}.}

\item{show_colnames}{Logical. Whether to display column names. Default is \code{TRUE}.}

\item{clustering_distance_rows}{Character string specifying the distance metric
for row clustering. See \code{\link[stats]{dist}} for details. One of:
\code{"euclidean"} (default), \code{"maximum"}, \code{"manhattan"},
\code{"canberra"}, \code{"binary"}, \code{"minkowski"}.}

\item{clustering_distance_cols}{Character string specifying the distance metric
for column clustering. Same options as \code{clustering_distance_rows}.
Default is \code{"euclidean"}.}

\item{clustering_method}{Character string specifying the clustering algorithm.
See \code{\link[stats]{hclust}} for details. One of:
\itemize{
\item \code{"ward.D"}: Ward's minimum variance method (default)
\item \code{"ward.D2"}: Implements Ward's (1963) criterion
\item \code{"single"}: Single linkage clustering
\item \code{"complete"}: Complete linkage clustering
\item \code{"average"}: UPGMA clustering
\item \code{"mcquitty"}: WPGMA clustering
\item \code{"median"}: WPGMC clustering
\item \code{"centroid"}: UPGMC clustering
}}

\item{significance_threshold}{Numeric value between 0 and 1 specifying the
p-value threshold for significance masking in correlation plots.
Default is 0.05.}

\item{color_palette}{Character vector of length 3 specifying colors for
negative correlations, neutral/non-significant, and positive correlations.
Default is \code{c("blue", "white", "red")}.}

\item{fontsize_main}{Numeric value for main title font size. Default is 12.}

\item{fontsize_labels}{Numeric value for axis label font size. Default is 8.}
}
\value{
A list containing:
\describe{
\item{\code{plot}}{The generated heatmap plot object}
\item{\code{filtered_data}}{Data frame of filtered data used for plotting}
\item{\code{correlation_matrix}}{Correlation matrix (correlation plots only)}
\item{\code{p_values}}{Matrix of p-values (correlation plots only)}
\item{\code{top_features}}{Names of selected top variable features/samples}
\item{\code{iqr_values}}{Data frame of IQR values for all features/samples}
\item{\code{parameters}}{List of all function parameters used}
\item{\code{summary_stats}}{Summary statistics of the analysis}
}
}
\description{
Generates correlation or hierarchical clustering heatmaps with advanced filtering
capabilities. The function creates publication-ready visualizations by selecting
the most variable features/samples based on interquartile range (IQR) and applies
statistical significance masking for correlation plots. Automatically selects the
appropriate data source based on replicate merging settings.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates input parameters and data structure
\item Automatically selects between \code{data_scaledPCA_varFiltered} and \code{data_scaledPCA_merged} based on \code{auto_merge_replicates} parameter
\item Calculates interquartile ranges (IQR) to identify most variable features/samples
\item Selects top N most variable features/samples based on IQR
\item For correlation plots: computes correlation matrix with p-values and applies significance masking
\item For hierarchical plots: uses raw filtered data with clustering
\item Generates publication-ready heatmap with customizable aesthetics
}

For correlation plots, non-significant correlations (p >= significance_threshold)
are displayed as neutral color (white by default) to highlight statistically
significant relationships.
}
\examples{
\dontrun{
# Basic correlation heatmap
result <- plot_CorrelationHeatmap(
  data = preprocessed_data,
  method = "pearson",
  plot_top_n = 500
)

# Hierarchical clustering of samples
result <- plot_CorrelationHeatmap(
  data = preprocessed_data,
  plot_what = "Samples",
  plot_type = "hierarchical",
  clustering_method = "ward.D2"
)

# Custom correlation plot with Spearman correlation
result <- plot_CorrelationHeatmap(
  data = preprocessed_data,
  method = "spearman",
  significance_threshold = 0.01,
  color_palette = c("darkblue", "grey90", "darkred")
)
}

}
\references{
Tukey, J. W. (1977). Exploratory Data Analysis. Reading: Addison-Wesley. (for IQR)

Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988). The New S Language. Wadsworth & Brooks/Cole. (for cor)

Kendall, M. G. (1938). A new measure of rank correlation, Biometrika, 30, 81â€"93. doi:10.1093/biomet/30.1-2.81. (for cor)

Kendall, M. G. (1945). The treatment of ties in rank problems. Biometrika, 33 239â€"251. doi:10.1093/biomet/33.3.239 (for cor)

Hollander M. and Wolfe D.A. (1973). Nonparametric Statistical Methods. New York: Wiley. (for Hmisc::rcorr)

Press WH, Flannery BP, Teukolsky SA, Vetterling, WT (1988): Numerical Recipes in C. Cambridge: Cambridge University Press. (for Hmisc::rcorr)

Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language. Wadsworth & Brooks/Cole. (for stats::dist and stats::hclust in pheatmap)

Mardia, K. V., Kent, J. T. and Bibby, J. M. (1979) Multivariate Analysis. Academic Press. (for stats::dist in pheatmap)

Borg, I. and Groenen, P. (1997) Modern Multidimensional Scaling. Theory and Applications. Springer. (for stats::dist in pheatmap)

Everitt, B. (1974). Cluster Analysis. London: Heinemann Educ. Books. (for stats::hclust in pheatmap)

Hartigan, J.A. (1975). Clustering Algorithms. New York: Wiley. (for stats::hclust in pheatmap)

Sneath, P. H. A. and R. R. Sokal (1973). Numerical Taxonomy. San Francisco: Freeman. (for stats::hclust in pheatmap)

Anderberg, M. R. (1973). Cluster Analysis for Applications. Academic Press: New York. (for stats::hclust in pheatmap)

Gordon, A. D. (1999). Classification. Second Edition. London: Chapman and Hall / CRC (for stats::hclust in pheatmap)

Murtagh, F. (1985). â€œMultidimensional Clustering Algorithmsâ€, in COMPSTAT Lectures 4. Wuerzburg: Physica-Verlag (for algorithmic details of algorithms used). (for stats::hclust in pheatmap)

McQuitty, L.L. (1966). Similarity Analysis by Reciprocal Pairs for Discrete and Continuous Data. Educational and Psychological Measurement, 26, 825â€"831. doi:10.1177/001316446602600402. (for stats::hclust in pheatmap)

Legendre, P. and L. Legendre (2012). Numerical Ecology, 3rd English ed. Amsterdam: Elsevier Science BV. (for stats::hclust in pheatmap)

Murtagh, Fionn and Legendre, Pierre (2014). Ward's hierarchical agglomerative clustering method: which algorithms implement Ward's criterion? Journal of Classification, 31, 274â€"295. doi:10.1007/s00357-014-9161-z. (for stats::hclust in pheatmap)
}
\seealso{
\code{\link[stats]{cor}}, \code{\link[Hmisc]{rcorr}}, \code{\link[pheatmap]{pheatmap}}
}
\author{
John Lennon L. Calorio
}
