% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_LMEM.R
\name{perform_LMEM}
\alias{perform_LMEM}
\title{Perform Linear Mixed-Effects Model Analysis}
\usage{
perform_LMEM(
  df,
  featMet_names,
  model_formula = NULL,
  group_cat1 = NULL,
  group_cat2 = NULL,
  group_cat1_col = "Group",
  group_cat2_col = "Group2",
  subject_col = "SubjectID",
  response_col = "Response",
  adj_p = "BH",
  stars = TRUE,
  exclude_qc = TRUE
)
}
\arguments{
\item{df}{A data frame containing the data to be analyzed.}

\item{featMet_names}{A character vector of column names representing the
features or metabolites to be analyzed.}

\item{model_formula}{A character string representing the LMEM formula (e.g.,
"Response ~ Start + End + (1|SubjectID)"). This is a required parameter.}

\item{group_cat1}{A character vector of the two expected categories in
\code{group_cat1_col} that represent the paired measurements (e.g.,
\code{c("Start", "End")}).}

\item{group_cat2}{A character vector of categories for an optional second
grouping variable, such as different lung sections (e.g., \code{c("Left", "Right")}).
If \code{NULL}, this grouping is ignored.}

\item{group_cat1_col}{A character string specifying the column name containing
the paired categories (default: "Group").}

\item{group_cat2_col}{A character string specifying the column name for the
optional second grouping variable (default: "Group2").}

\item{subject_col}{A character string specifying the column name for subject
identifiers (default: "SubjectID").}

\item{response_col}{A character string specifying the column name for the
response variable (e.g., "IschemiaTime"; default: "Response"). This column
must be numeric.}

\item{adj_p}{A character string specifying the p-value adjustment method to
be passed to \code{\link[stats]{p.adjust}}. The default is "BH" (Benjamini-Hochberg).
Use "none" for no adjustment.}

\item{stars}{A logical value. If \code{TRUE}, adds significance stars to the
results based on the adjusted p-value (default: \code{TRUE}).}

\item{exclude_qc}{A logical value. If \code{TRUE}, removes rows where the
value in \code{group_cat1_col} is "QC" (default: \code{TRUE}).}
}
\value{
A list containing the results of the analysis. The list includes:
\describe{
\item{Individual results for each feature/metabolite:}{Each element is a list
with the fitted model object, fixed and random effects, and diagnostics.}
\item{Combined_Fixed_Effects_Summary:}{A data frame summarizing the fixed
effects from all successful models, including adjusted p-values.}
\item{Processing_Summary:}{A list with a summary of the analysis, including
the number of successful and failed models.}
}
}
\description{
This function automates the process of fitting Linear Mixed-Effects Models (LMEMs)
to a dataset, typically for analyzing paired or grouped metabolic data. It iterates
through a list of features/metabolites, prepares the data for each, fits an LMEM,
and extracts key results, including fixed effects, random effects, and model diagnostics.
The function is designed to handle common data structures from clinical studies,
where multiple measurements (e.g., 'Start' and 'End') are taken from the same subject.
It also includes data validation, error handling, and p-value adjustment.
}
\examples{
\dontrun{
# Example data setup
library(dplyr)
df_lm <- data.frame(
  SubjectID = rep(1:20, each = 2),
  Group = rep(c("Start", "End"), 20),
  IschemiaTime = runif(40, 10, 60),
  MetaboliteA = rnorm(40, mean = c(5, 7), sd = 1),
  MetaboliteB = rnorm(40, mean = c(12, 11), sd = 2)
)

# Perform LMEM analysis for two metabolites
results <- perform_LMEM(
  df = df_lm,
  featMet_names = c("MetaboliteA", "MetaboliteB"),
  model_formula = "IschemiaTime ~ Start + End + (1|SubjectID)",
  group_cat1 = c("Start", "End"),
  response_col = "IschemiaTime"
)

# View combined results table
print(results$Combined_Fixed_Effects_Summary)

# View details for a single metabolite
print(summary(results$MetaboliteA$Model_Object))
}

}
\author{
John Lennon L. Calorio
}
