% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_ComparativeAnalysis.R
\name{perform_ComparativeAnalysis}
\alias{perform_ComparativeAnalysis}
\title{Perform Comparative Statistical Analysis on Preprocessed Metabolomics Data}
\usage{
perform_ComparativeAnalysis(
  data,
  adjust_p_method = "BH",
  sort_p = TRUE,
  paired = FALSE,
  plot_metabolites = NULL,
  alpha = 0.05,
  min_group_size = 3,
  verbose = FALSE
)
}
\arguments{
\item{data}{List. Output from \code{perform_PreprocessingPeakData} function containing:
\itemize{
\item \code{data_scaledPCA_rsdFiltered_varFiltered}: Numeric matrix of processed metabolite data
\item \code{Metadata}: Data frame with sample metadata including 'Group' column
}}

\item{adjust_p_method}{Character. Method for p-value adjustment. Default is "BH".
Options include:
\itemize{
\item "holm": Holm (1979) - Controls family-wise error rate
\item "hochberg": Hochberg (1988) - Less conservative than Bonferroni
\item "hommel": Hommel (1988) - More powerful than Hochberg
\item "bonferroni": Classical Bonferroni correction
\item "BH": Benjamini & Hochberg (1995) - Controls false discovery rate
\item "BY": Benjamini & Yekutieli (2001) - More conservative FDR control
\item "fdr": Alias for "BH"
\item "none": No adjustment
}}

\item{sort_p}{Logical. If \code{TRUE} (default), results are sorted by adjusted p-values
in ascending order.}

\item{paired}{Logical. If \code{TRUE}, performs paired sample tests. Default is \code{FALSE}.
Note: Requires equal group sizes for multi-group comparisons.}

\item{plot_metabolites}{Character vector. Names of metabolites to visualize. If provided,
generates statistical plots using \code{ggstatsplot}. Default is \code{NULL} (no plots).}

\item{alpha}{Numeric. Significance threshold for assumption tests. Default is 0.05.}

\item{min_group_size}{Integer. Minimum required sample size per group. Default is 3.}

\item{verbose}{Logical. If \code{TRUE}, prints detailed progress information. Default is \code{FALSE}.}
}
\value{
List containing:
\itemize{
\item \code{results}: Data frame with statistical test results for each metabolite
\item \code{plots}: List of ggplot objects (if \code{plot_metabolites} specified)
\item \code{summary}: Summary statistics of the analysis
\item \code{assumptions}: Results of assumption tests
\item \code{metadata}: Analysis metadata and parameters used
}
}
\description{
Conducts comprehensive comparative statistical analysis on preprocessed metabolomics data.
The function automatically selects appropriate statistical tests based on data characteristics
including normality, variance homogeneity, and sample independence. Supports both two-group
and multi-group comparisons with parametric and non-parametric alternatives.
}
\details{
The function performs the following workflow:
\enumerate{
\item Validates input data structure and parameters
\item Removes quality control samples from analysis
\item Tests statistical assumptions (normality, variance homogeneity)
\item Selects appropriate statistical tests automatically
\item Applies multiple comparison corrections
\item Generates optional visualization plots
}

For two-group comparisons, the function chooses between:
\itemize{
\item Paired/Independent t-test (parametric)
\item Welch's t-test (unequal variances)
\item Mann-Whitney U test (non-parametric)
\item Wilcoxon signed-rank test (paired non-parametric)
}

For multi-group comparisons:
\itemize{
\item One-way ANOVA (parametric)
\item Repeated measures ANOVA (paired)
\item Kruskal-Wallis test (non-parametric)
}
}
\examples{
\dontrun{
# Basic two-group comparison
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  adjust_p_method = "BH"
)

# Paired comparison with plots
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  paired = TRUE,
  plot_metabolites = c("metabolite_1", "metabolite_2"),
  verbose = TRUE
)

# Multi-group comparison with strict correction
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  adjust_p_method = "bonferroni",
  sort_p = TRUE
)
}

}
\references{
Bartlett, M. S. (1937). Properties of sufficiency and statistical tests. Proceedings of the Royal Society of London Series A 160, 268–282. doi:10.1098/rspa.1937.0109. (for bartlett.test)

David F. Bauer (1972). Constructing confidence sets using rank statistics. Journal of the American Statistical Association 67, 687–690. doi:10.1080/01621459.1972.10481279. (for wilcox.test)

Myles Hollander and Douglas A. Wolfe (1973). Nonparametric Statistical Methods. New York: John Wiley & Sons. Pages 27–33 (one-sample), 68–75 (two-sample). Or second edition (1999). (for wilcox.test)

Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988). The New S Language. Wadsworth & Brooks/Cole. (for var)

Kendall, M. G. (1938). A new measure of rank correlation, Biometrika, 30, 81–93. doi:10.1093/biomet/30.1-2.81. (for var)

Kendall, M. G. (1945). The treatment of ties in rank problems. Biometrika, 33 239–251. doi:10.1093/biomet/33.3.239 (for var)

Chambers, J. M. (1992) Linear models. Chapter 4 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole. (for lm)

Wilkinson, G. N. and Rogers, C. E. (1973). Symbolic descriptions of factorial models for analysis of variance. Applied Statistics, 22, 392–399. doi:10.2307/2346786. (for lm)

Chambers, J. M., Freeny, A and Heiberger, R. M. (1992) Analysis of variance; designed experiments. Chapter 5 of Statistical Models in S eds J. M. Chambers and T. J. Hastie, Wadsworth & Brooks/Cole. (for aov)

Myles Hollander and Douglas A. Wolfe (1973), Nonparametric Statistical Methods. New York: John Wiley & Sons. Pages 115–120. (for kruskal.test)

Patrick Royston (1982). An extension of Shapiro and Wilk's W test for normality to large samples. Applied Statistics, 31, 115–124. doi:10.2307/2347973. (for shapiro.test)

Patrick Royston (1982). Algorithm AS 181: The W test for Normality. Applied Statistics, 31, 176–180. doi:10.2307/2347986. (for shapiro.test)

Patrick Royston (1995). Remark AS R94: A remark on Algorithm AS 181: The W test for normality. Applied Statistics, 44, 547–551. doi:10.2307/2986146. (for shapiro.test)

Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57, 289–300. doi:10.1111/j.2517-6161.1995.tb02031.x. (for p.adjust)

Benjamini, Y., and Yekutieli, D. (2001). The control of the false discovery rate in multiple testing under dependency. Annals of Statistics, 29, 1165–1188. doi:10.1214/aos/1013699998. (for p.adjust)

Holm, S. (1979). A simple sequentially rejective multiple test procedure. Scandinavian Journal of Statistics, 6, 65–70. https://www.jstor.org/stable/4615733. (for p.adjust)

Hommel, G. (1988). A stagewise rejective multiple test procedure based on a modified Bonferroni test. Biometrika, 75, 383–386. doi:10.2307/2336190. (for p.adjust)

Hochberg, Y. (1988). A sharper Bonferroni procedure for multiple tests of significance. Biometrika, 75, 800–803. doi:10.2307/2336325. (for p.adjust)

Shaffer, J. P. (1995). Multiple hypothesis testing. Annual Review of Psychology, 46, 561–584. doi:10.1146/annurev.ps.46.020195.003021. (An excellent review of the area.) (for p.adjust)

Sarkar, S. (1998). Some probability inequalities for ordered MTP2 random variables: a proof of Simes conjecture. Annals of Statistics, 26, 494–504. doi:10.1214/aos/1028144846. (for p.adjust)

Sarkar, S., and Chang, C. K. (1997). The Simes method for multiple hypothesis testing with positively dependent test statistics. Journal of the American Statistical Association, 92, 1601–1608. doi:10.2307/2965431. (for p.adjust)

Wright, S. P. (1992). Adjusted P-values for simultaneous inference. Biometrics, 48, 1005–1013. doi:10.2307/2532694. (Explains the adjusted P-value approach.) (for p.adjust)
}
\seealso{
\code{\link{perform_PreprocessingPeakData}}, \code{\link[stats]{t.test}},
\code{\link[stats]{aov}}, \code{\link[ggstatsplot]{ggbetweenstats}}
}
\author{
John Lennon L. Calorio
}
