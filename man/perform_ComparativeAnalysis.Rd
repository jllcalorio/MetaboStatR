% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perform_ComparativeAnalysis.R
\name{perform_ComparativeAnalysis}
\alias{perform_ComparativeAnalysis}
\title{Perform Comparative Statistical Analysis on Preprocessed Metabolomics Data}
\usage{
perform_ComparativeAnalysis(
  data,
  adjust_p_method = "BH",
  sort_p = TRUE,
  paired = FALSE,
  plot_metabolites = NULL,
  alpha = 0.05,
  min_group_size = 3,
  verbose = FALSE,
  num_cores = 1
)
}
\arguments{
\item{data}{List. Output from \code{perform_PreprocessingPeakData} function containing:
\itemize{
\item \code{data_scaledNONPLS_varFiltered}: Numeric matrix of processed metabolite data
\item \code{Metadata}: Data frame with sample metadata including 'Group' column
}}

\item{adjust_p_method}{Character. Method for p-value adjustment, passed to
\code{auto_compare}. Default is "BH". Options include:
\itemize{
\item "holm": Holm (1979) - Controls family-wise error rate
\item "hochberg": Hochberg (1988) - Less conservative than Bonferroni
\item "hommel": Hommel (1988) - More powerful than Hochberg
\item "bonferroni": Classical Bonferroni correction
\item "BH": Benjamini & Hochberg (1995) - Controls false discovery rate
\item "BY": Benjamini & Yekutieli (2001) - More conservative FDR control
\item "fdr": Alias for "BH"
\item "none": No adjustment
}}

\item{sort_p}{Logical. If \code{TRUE} (default), results are sorted by the
adjusted post-hoc p-values in ascending order.}

\item{paired}{Logical. If \code{TRUE}, performs paired sample tests (passed to
\code{auto_compare}). Default is \code{FALSE}.}

\item{plot_metabolites}{Character vector. Names of metabolites to visualize. If provided,
generates statistical plots using \code{ggstatsplot}. Default is \code{NULL} (no plots).}

\item{alpha}{Numeric. Significance threshold passed to \code{auto_compare} for
assumption tests (\code{alpha_normality}, \code{alpha_variance}) and the main
test (\code{test_alpha}). Default is 0.05.}

\item{min_group_size}{Integer. Minimum required sample size per group. Default is 3.}

\item{verbose}{Logical. If \code{TRUE}, prints detailed progress information. Default is \code{FALSE}.}

\item{num_cores}{Integer or "max" specifying the number of cores to be used.}
}
\value{
List containing:
\itemize{
\item \code{results}: Data frame with statistical test results for each metabolite.
Includes \code{posthoc_test_used} and a combined \code{interpretation} column.
\item \code{plots}: List of ggplot objects (if \code{plot_metabolites} specified)
\item \code{summary}: Summary statistics of the analysis
\item \code{metadata}: Analysis metadata and parameters used
}
}
\description{
Conducts comprehensive comparative statistical analysis on preprocessed metabolomics data
by iterating over each metabolite and applying the 'auto_compare' function.
}
\details{
This function serves as a wrapper for the \code{auto_compare} function, applying
it to each metabolite (column) in a metabolomics data matrix.

The function performs the following workflow:
\enumerate{
\item Validates input data structure and parameters.
\item Removes quality control samples from analysis.
\item For each metabolite, it combines the data with the group metadata.
\item Calls \code{auto_compare} to select and perform the appropriate statistical test.
\item Aggregates the results from all metabolites into a single data frame.
\item Applies the specified p-value adjustment method \emph{within} each call to \code{auto_compare}
for post-hoc tests.
\item Generates optional visualization plots using \code{ggstatsplot}.
}

\strong{NOTE:} This function requires the \code{auto_compare} function to be
loaded into the R environment (e.g., by sourcing \code{auto_compare.R}).
}
\examples{
\dontrun{
# Assuming 'auto_compare.R' has been sourced
# source("auto_compare.R")

# Basic two-group comparison
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  adjust_p_method = "BH"
)

# Paired comparison with plots
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  paired = TRUE,
  plot_metabolites = c("metabolite_1", "metabolite_2"),
  verbose = TRUE
)

# Multi-group comparison with strict correction
results <- perform_ComparativeAnalysis(
  data = preprocessed_data,
  adjust_p_method = "bonferroni",
  sort_p = TRUE
)
}

}
\seealso{
\code{\link{perform_PreprocessingPeakData}}, \code{auto_compare},
\code{\link[ggstatsplot]{ggbetweenstats}}
}
\author{
John Lennon L. Calorio
}
